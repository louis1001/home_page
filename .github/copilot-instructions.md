# Copilot Instructions

- **Project**: SvelteKit site built for static export; adapter-static is configured and layouts set `prerender = true` (see src/routes/(internal)/(main)/+layout.ts and src/routes/(external)/+layout.ts). Trailing slashes are forced in section/external layouts.
- **Dev/Checks**: `npm install`; `npm run dev` for local preview; use `npm run check` to validate changes instead of building.
- **Routing Layouts**: Internal pages share [src/routes/(internal)/+layout.svelte](src/routes/(internal)/+layout.svelte) which mounts the p5 background, nav bar, footer, and injects global styles. The `(main)` child layout is a plain slot, while `(section)` wraps content in a `<main>` element (see [src/routes/(internal)/(section)/+layout.svelte](src/routes/(internal)/(section)/+layout.svelte)). External routes (e.g., CV) live under `(external)` with their own prerender config.
- **Global Styling**: Styles are injected in the `<svelte:head>` of the internal layout via Sass imports (reset, basics, section, font styles). Color/theme tokens live in [src/lib/assets/styles/basics.sass](src/lib/assets/styles/basics.sass); typography in [src/lib/assets/styles/font_styles.sass](src/lib/assets/styles/font_styles.sass); layout defaults in [src/lib/assets/styles/section.sass](src/lib/assets/styles/section.sass). Keep additions consistent with these tokens.
- **Assets/Images**: Uses `@sveltejs/enhanced-img` (configured in vite.config.ts) and `enhanced:img` elements across components; ensure new images are placed under `static/` or `$lib/assets/` and reference via enhanced sources when possible.
- **Background Graphics**: A persistent p5 canvas is initialized in [src/lib/components/global/p5/graphics.svelte](src/lib/components/global/p5/graphics.svelte), calling `load()` from [src/lib/components/global/p5/graphics.ts](src/lib/components/global/p5/graphics.ts). Sketches respect `prefers-reduced-motion`; add new sketches to the `sketches` array.
- **Navigation/Footer**: Nav bar links main sections (home, CV, demos, interests) from [src/lib/components/global/nav_bar.svelte](src/lib/components/global/nav_bar.svelte); footer is minimal ([src/lib/components/global/footer.svelte](src/lib/components/global/footer.svelte)). Update links in nav when adding top-level routes.
- **Home Page**: [src/routes/(internal)/(main)/+page.svelte](src/routes/(internal)/(main)/+page.svelte) composes the header ([src/lib/components/global/header.svelte](src/lib/components/global/header.svelte)) and job badge ([src/lib/components/home/job_desc.svelte](src/lib/components/home/job_desc.svelte)). Header uses `enhanced:img` pointing to static/site-images.
- **Interests/Photography**: Photography page ([src/routes/(internal)/(section)/interests/photography/+page.svelte](src/routes/(internal)/(section)/interests/photography/+page.svelte)) lazily glob-imports processed photos via `import.meta.glob` with `{ query: { enhanced: true } }` and powers a BiggerPicture gallery. Keep new photos under `$lib/assets/photos/` and ensure `@sveltejs/enhanced-img` is available. Spinner component shows loading state.
- **Interests/Web Projects**: Repo list ([src/routes/(internal)/(section)/interests/web_projects/+page.svelte](src/routes/(internal)/(section)/interests/web_projects/+page.svelte)) uses the `useFetchRepos` rune-based hook in [scripts/fetchRepos.svelte.ts](src/routes/(internal)/(section)/interests/web_projects/scripts/fetchRepos.svelte.ts) to fetch public GitHub repos, filter ones with `has_pages`, and expose `demoUrl()`/links. It relies on browser fetch; avoid SSR-only usage.
- **Runes Usage**: Components leverage Svelte 5 runes (`$state`, `$effect`, `$props`). When extending these files, keep rune usage consistent and avoid mixing with legacy `onMount`/stores unless necessary.
- **Trailing Slash Behavior**: `(section)` and `(external)` layouts set `trailingSlash = 'always'`; keep new sibling routes aligned to avoid mixed slash behavior on static hosting.
- **Enhanced Assets in Head**: Fonts are pulled from Google in [src/app.html](src/app.html); keep typography changes there. Favicon is referenced via `%sveltekit.assets%/favicon.ico` and `/favicon.ico` meta.
- **Static CV Page**: The CV under [src/routes/(external)/cv/+page.svelte](src/routes/(external)/cv/+page.svelte) is fully static and Sass-styled; avoid adding client-side logic that would break prerendering.
- **Custom Highlighting**: A small regex-based syntax highlighter lives in [src/highlighting/highlighting.ts](src/highlighting/highlighting.ts) with language definitions in [src/highlighting/languages.ts](src/highlighting/languages.ts). Add rules there when introducing new demo languages.
- **Loading UI**: Shared spinner at [src/lib/components/global/spinner.svelte](src/lib/components/global/spinner.svelte) expects `isLoading` prop; prefer reusing it for async UI.
- **Static Hosting Expectations**: Site assumes full prerender/static export; avoid server routes and prefer client-side fetches that work from a static host (GitHub Pages style). When adding new data, consider embedding or hitting public APIs at runtime.
- **Animations/Accessibility**: p5 background respects reduced motion. Ensure new animations also guard `prefers-reduced-motion` and keep contrast with the dark palette defined in basics.sass.
- **File Organization**: Svelte components live under `src/lib/components`, with route pages under `src/routes/(internal|external)/...`. Assets are under `static/` (served as-is) or `src/lib/assets/` (build-processed). Keep new p5/graphics utilities under the existing `p5` folder.
- **Linting/Formatting**: No dedicated lint/test scripts are present. Match existing spacing (2 spaces in Svelte markup, Sass indentation) and stay ASCII unless assets require otherwise.

Need clarification or updates? Tell me what feels incomplete, and Iâ€™ll refine this guide.